<div id="box" style="border: 2px solid black; width: 1500px; height: 650px; margin-top:15px; margin-left:15px;">
  <div id="sprite" style="left: 50px; bottom: 0px; top: 300px; position:absolute;"></div>
  <div id="sprite2" style="left: 300px; bottom: 0px; top: 300px; position:absolute"></div>
  <div id="monster1" class="monster" style="position:absolute"></div>
  <div id="monster2" class="monster" style="position:absolute"></div>
  <div id="monster3" class="monster" style="position:absolute"></div>
</div>
<style>

   #monster1{
      width: 80px;
      height: 60px;
      background-image: url(<%= asset_path('monster1.png') %>);
      position: relative;
      transition: 0.1s linear;
  }

  #monster2{
    width: 120px;
      height: 70px;
      background-image: url(<%= asset_path('monster2.png') %>);
      position: relative;
      transition: 0.1s linear;
  }

  #monster3{
      width: 80px;
      height: 60px;
      background-image: url(<%= asset_path('monster3.png') %>);
      position: relative;
      transition: 0.1s linear;
  }

  #box {
     background-image: url(<%= asset_path('forest.jpg') %>);
     width: 100%;
     height: 100%;
  }
  #sprite2 {
      width: 170px;
      height: 130px;
      background-image: url(<%= asset_path('house.png') %>);
      position: relative;
      transition: 0.1s linear;
  }
  #sprite {
      width: 45px;
      height: 60px;
      background-image: url(<%= asset_path('hero.png') %>);
      position: relative;
      transition: 0.1s linear;
  }
</style>
<script>

  const box = document.querySelector('#box');
  const monsters = document.querySelectorAll('.monster');
  const positions = [
    { left: '50px', top: '100px' },
    { left: '200px', top: '200px' },
    { left: '300px', top: '300px' },
    { left: '500px', top: '150px' },
    { left: '600px', top: '250px' },
  ];

    const shuffleArray = (array) => {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  };

     const assignRandomPositions = () => {
    const shuffledPositions = shuffleArray(positions.slice());
    for (let i = 0; i < monsters.length; i++) {
      const monster = monsters[i];
      const { left, top } = shuffledPositions[i];
      monster.style.left = left;
      monster.style.top = top;
    }
  };
   assignRandomPositions();

  const sprite = document.querySelector('#sprite');
  const sprite2 = document.querySelector('#sprite2');
  const button = document.querySelector('button');
  let speed = 5;

  const toNum = (pxVal) => {
      return parseInt(pxVal, 10);
  };

    const resetSpritePosition = () => {
    sprite.style.left = '50px';
    sprite.style.top = '300px';
    }

  const handleMovement = (e) => {
      let left = toNum(sprite.style.left);
      const top = toNum(sprite.style.top);

      let left2 = toNum(sprite2.style.left);
      const top2 = toNum(sprite2.style.top);
      if (
      left >= left2 &&
      left <= left2 + sprite2.offsetWidth &&
      top >= top2 &&
      top <= top2 + sprite2.offsetHeight
  ) {
       console.log('Sprite 1 reached the location of Sprite 2!');
       window.location.href = '<%= show_village_maps_path %>';
       resetSpritePosition();
  }

      switch (e.key) {
          case 'ArrowLeft':
          case 'a':
              if (left <= 0) return (sprite.style.left = 0);
              sprite.style.left = left - speed + 'px';
              break;
          case 'ArrowRight':
          case 'd':
              if (left >= 1440) return (sprite.style.left = 1440);
              sprite.style.left = left + speed + 'px';
              break;
          case 'ArrowUp':
          case 'w':
              if (top <= 0) return (sprite.style.top = 0);
              sprite.style.top = top - speed + 'px';
              break;
          case 'ArrowDown':
          case 's':
              if (top >= 600) return (sprite.style.top = 600);
              sprite.style.top = top + speed + 'px';
              break;
      }
  };

  window.addEventListener('keydown', handleMovement);

  button.addEventListener('click', () => (speed += 5));
</script>
